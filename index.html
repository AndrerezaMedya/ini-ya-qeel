<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asrama Salman - Coaching Form</title>
    <link rel="icon" href="https://i.imgur.com/iAHp5lq.png">
    <link rel="stylesheet" href="style.css">
    
    <!-- Library Eksternal -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs@3/dist/fp.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>
</head>
<body>

    <!-- Background handled by body::before (passive 2-color gradient) -->


    <div id="music-hint-popup">Atur Audio di Sini! ğŸ‘‡</div>

    <div id="music-player-panel">
        <div class="player-section">
            <h4>Musik Latar</h4>
            <div id="music-controls">
                <p id="current-track-title">Memuat...</p>
                <div class="player-controls">
                    <button id="prev-music-btn" title="Sebelumnya"><svg viewBox="0 0 24 24"><path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"></path></svg></button>
                    <button id="play-pause-btn" title="Jeda/Putar"></button>
                    <button id="next-music-btn" title="Selanjutnya"><svg viewBox="0 0 24 24"><path d="M16 6h2v12h-2zm-3.5 6l-8.5 6V6z"></path></svg></button>
                </div>
            </div>
        </div>
        <div class="player-section">
            <h4>Murottal</h4>
            <div id="murottal-list"></div>
        </div>
    </div>

    <div id="theme-toggle-btn" title="Ganti Tema">
        <svg id="icon-sun" viewBox="0 0 24 24"><path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.64 5.64c.39.39 1.02.39 1.41 0s.39-1.02 0-1.41L5.64 2.81c-.39-.39-1.02-.39-1.41 0s-.39 1.02 0 1.41L5.64 5.64zm12.73 12.73c.39.39 1.02.39 1.41 0s.39-1.02 0-1.41l-1.41-1.41c-.39-.39-1.02-.39-1.41 0s-.39 1.02 0 1.41l1.41 1.41zM2.81 18.36c.39.39 1.02.39 1.41 0s.39-1.02 0-1.41l-1.41-1.41c-.39-.39-1.02-.39-1.41 0s-.39 1.02 0 1.41l1.41 1.41zm14.14-14.14c.39.39 1.02.39 1.41 0s.39-1.02 0-1.41l-1.41-1.41c-.39-.39-1.02-.39-1.41 0s-.39 1.02 0 1.41l1.41 1.41z"></path></svg>
        <svg id="icon-moon" style="display:none;" viewBox="0 0 24 24"><path d="M10 2c-1.82 0-3.53.5-5 1.35C7.99 5.08 10 8.3 10 12s-2.01 6.92-5 8.65C6.47 21.5 8.18 22 10 22c5.52 0 10-4.48 10-10S15.52 2 10 2z"></path></svg>
    </div>

    <div id="audio-control-btn" title="Buka Pengaturan Audio">
        <svg id="icon-music-player" viewBox="0 0 24 24"><path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"></path></svg>
        <svg id="icon-close-player" style="display:none;" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
    </div>

    <div id="gacha-overlay">
        <video id="gacha-background" src="https://github.com/AndrerezaMedya/surveyhth/raw/refs/heads/main/wish_background_loop.webm" loop muted playsinline webkit-playsinline preload="auto"></video>
        <img id="gacha-settle-bg" src="https://github.com/AndrerezaMedya/surveyhth/raw/refs/heads/main/gacha_settle.webp" alt="Gacha Result Background">

        <video id="gacha-ing-r4" src="https://github.com/AndrerezaMedya/surveyhth/raw/refs/heads/main/wish_ing_rarity4.webm" muted playsinline webkit-playsinline preload="auto"></video>
        <video id="gacha-ing-r5" src="https://github.com/AndrerezaMedya/surveyhth/raw/refs/heads/main/wish_ing_rarity5.webm" muted playsinline webkit-playsinline preload="auto"></video>

        <div id="gacha-result-container" class="hidden">
            <img id="gacha-result-item" src="" alt="Hasil Gacha">
            <div id="gacha-result-stars">
                </div>
            <div id="gacha-result-message"></div>
        </div>

        <div id="gacha-control-panel">
            <div id="gacha-idle-controls">
                <div id="gacha-progress-container">
                    <div id="gacha-progress-bar"></div>
                    <span id="gacha-progress-text">Loading assets... 0%</span>
                </div>
                <button id="gacha-pull-btn" class="btn" disabled>Pull!</button>
                <button id="gacha-back-btn" class="btn btn-secondary">Balik</button>
                <button id="gacha-inventory-open-idle" class="btn btn-secondary">Inventory</button>
            </div>
            <div id="gacha-result-controls" class="hidden">
                <button id="gacha-pull-again-btn" class="btn">Pull lagi euy</button>
                <button id="gacha-back-from-result-btn" class="btn btn-secondary">Balik</button>
                <button id="gacha-inventory-open-result" class="btn btn-secondary">Inventory</button>
            </div>
        </div>
    </div>

    <!-- Inventory Modal -->
    <div id="gacha-inventory-modal" class="modal-overlay">
        <div class="modal-content">
            <div style="display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:8px;">
                <h2 style="margin:0;">Inventory</h2>
                <button id="gacha-inventory-close" class="btn btn-secondary">Tutup</button>
            </div>
            <div id="inventory-empty" class="inventory-empty" style="display:none; margin:8px 0 12px;">Belum ada item. Coba gacha dulu ya!</div>
            <div id="gacha-inventory-list" class="inventory-grid"></div>
        </div>
    </div>

    <div id="page-coach-selection" class="page">
        <div class="selection-container">
            <h1>Pilih Coach Kamu</h1>
            <h2>Astra</h2>
            <div id="coach-grid-putra" class="grid-container"></div>
            <h2>Astir</h2>
            <div id="coach-grid-putri" class="grid-container"></div>
        </div>
    </div>

    <div id="page-member-selection" class="page">
        <div class="selection-container">
            <h1 id="member-selection-title">Pilih Namamu</h1>
            <div id="member-list" class="member-list"></div>
            <button id="back-to-coach-btn" class="btn btn-secondary back-btn"><span>â† Kembali Pilih Coach</span></button>
        </div>
    </div>

    <div id="page-circle-of-life" class="page">
        <div class="form-container">
            <div class="col-container">
                <div class="col-chart-container">
                    <canvas id="myChart"></canvas>
                </div>
                <div class="col-controls-container">
                    <h2 id="col-title">Your Circle of Life</h2>
                    <div id="col-sliders"></div>
                    <button id="submitBtn" class="btn btn-primary">Lanjut Coachh</button>
                    <p id="status-message"></p>
                    <p id="average-message-desktop"></p> 
                    <button id="open-context-btn" class="context-btn">Apa maksud parameter ini?</button>
                </div>
            </div>
            <button id="back-to-member-btn" class="btn btn-secondary back-btn"><span>â† Kembali Pilih Anggota</span></button>
        </div>
    </div>
    
    <div id="page-happy-story" class="page">
        <div class="form-container">
            <h2 id="happy-story-title">Dikit lagi...</h2>
            <p id="happy-story-prompt">Apa yang bikin kamu senyum belakangan ini? Boleh banget lho berbagi sedikit cerita di sini ğŸ˜„</p>
            <textarea id="happy-story-textarea" class="story-textarea" placeholder="Misal: 'Aku seneng banget kemarin bisa video call sama orang tua...'"></textarea>
            <div class="button-group">
                <button id="back-to-col-btn" class="btn btn-secondary back-btn"><span>â† Kembali ke CoL</span></button>
                <button id="happy-story-continue-btn" class="btn btn-primary">Lanjut</button>
            </div>
        </div>
    </div>

    <div id="page-sad-story" class="page">
        <div class="form-container">
            <h2 id="sad-story-title">Terakhir nih...</h2>
            <p id="sad-story-prompt">Kalau ada yang lagi ngeganjel di hati, gak apa-apa kok dikeluarin di sini. Kadang, nulis bisa bikin lega ğŸ˜Š</p>
            <textarea id="sad-story-textarea" class="story-textarea" placeholder="Misal: 'Aku lagi sedih karena ngerasa tugas kuliah berat banget...'"></textarea>
            <div class="button-group">
                 <button id="back-to-happy-btn" class="btn btn-secondary back-btn"><span>â† Sebelumnya</span></button>
                <button id="sad-story-continue-btn" class="btn btn-primary">Verifikasi & Kirim</button>
            </div>
        </div>
    </div>

    <div id="context-modal" class="modal-overlay">
        <div class="modal-content">
            <h2>Konteks Parameter Circle of Life</h2>
            <dl>
                <dt>Health (Kesehatan)</dt><dd>Seberapa bugar dan sehat kondisi fisikmu sebulan ini? Pokoknya mencakup pola makan, tidur, dan olahraga.</dd>
                <dt>Academic (Akademik)</dt><dd>Gimana progres kuliahmu? Apakah kamu merasa lancar dan bisa mengikuti pelajaran dengan baik?</dd>
                <dt>Family (Keluarga)</dt><dd>Seberapa harmonis hubunganmu dengan keluarga di rumah? Apakah komunikasi berjalan dengan baik? Minimal telepon mereka ya sraa.</dd>
                <dt>Friends (Teman)</dt><dd>Seberapa baik hubungan sosialmu? Lagi ngambekan kah? Dapet temen baru kah?</dd>
                <dt>Religion (Ruhiyah)</dt><dd>Gimana iman kamu? Kamu lagi semangat-semangatnya atau merasa futur?</dd>
                <dt>Organization (Organisasi)</dt><dd>Bagaimana kontribusi dan perkembanganmu di organisasi?</dd>
                <dt>Self-Love (Cinta Diri)</dt><dd>Seberapa baik kamu menerima dan menghargai dirimu sendiri, baik kelebihan maupun kekurangan?</dd>
                <dt>Learning (Pembelajaran)</dt><dd>Di luar kuliah, apakah kamu merasa terus belajar hal baru yang bermanfaat untuk pengembangan dirimu?</dd>
                <dt>Finances (Keuangan)</dt><dd>Seberapa aman dan tercukupi kondisi keuanganmu? Apakah kamu bisa mengelolanya dengan baik?</dd>
                <dt>Spirit (Semangat)</dt><dd>Seberapa tinggi semangat dan motivasimu untuk menjalani hari-hari dan meraih cita-cita?</dd>
            </dl>
            <button id="close-context-btn" class="btn btn-secondary" style="float: right;">Tutup</button>
        </div>
    </div>

    <div id="page-thank-you" class="page">
        <div class="selection-container thank-you-container">
            <p id="thank-you-message" class="thank-you-message"></p>
            <p id="coach-signature" class="coach-signature"></p>
            <div id="gemini-feedback-container" class="gemini-box" style="display:none; text-align:left; margin-top:16px;">
            <h3>Pesan Coach untukmu</h3>
            <div id="gemini-spinner" class="spinner" aria-label="Loading"></div>
            <div id="gemini-feedback-text" class="gemini-text" style="margin-top:8px;"></div>
            <button id="gemini-more-btn" class="btn btn-secondary" style="display:none; margin-top:12px;">
                Lebih mendalam lagi
            </button>
            </div>
        </div>
    </div>

    <div id="voice-verify-modal" class="modal-overlay">
        <div class="modal-content" style="text-align: center;">
            <h2>Eitss, ini beneran kamu?</h2>
            <p id="voice-prompt-message">Ucapkan Subhanallah/Alhamdulillah/Allahu akbar minimal 3x ya dengan memencet tombol mic supaya coach tau ini beneran kamu.</p>
            <button id="mic-btn">ğŸ¤</button>
            <p id="voice-status"></p>
            <div>
                <button id="voice-submit-btn" class="btn btn-success" disabled>Alhamdulillah aku dzikir hari ini!</button>
                <button id="voice-close-btn" class="btn btn-secondary">Eh ulang</button>
            </div>
        </div>
    </div>
    
    <div id="average-message-mobile"></div>

    
    <!-- === GACHA: tombol akses + hint (BARU) === -->
    <button id="gacha-access-btn" type="button" aria-label="Buka Gacha Motivasi">
    <!-- Ikon dadu (SVG) -->
    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
        <path d="M3 3h8v8H3V3zm10 0h8v8h-8V3zM3 13h8v8H3v-8zm10 0h8v8h-8v-8zM6 6.5a1.5 1.5 0 103 0 1.5 1.5 0 00-3 0zm10 0a1.5 1.5 0 103 0 1.5 1.5 0 00-3 0zM6 16.5a1.5 1.5 0 103 0 1.5 1.5 0 00-3 0zm10 0a1.5 1.5 0 103 0 1.5 1.5 0 00-3 0z"/>
    </svg>
    <span class="label">Gacha</span>
    </button>

    <div id="gacha-hint-popup">Gacha Penyemangatmu di sini! ğŸ‘‡</div>
    <!-- === /GACHA === -->

    <script src="main.js"></script>
</body>
</html>
